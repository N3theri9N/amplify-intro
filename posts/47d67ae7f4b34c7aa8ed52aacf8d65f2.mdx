---
title: í¬íŠ¸í´ë¦¬ì˜¤ ì œì‘ ë¹„í•˜ì¸ë“œ
date: 2024-01-21
---

# í¬íŠ¸í´ë¦¬ì˜¤ ì œì‘ ë¹„í•˜ì¸ë“œ

ìƒì„± ì¼ì‹œ: 2024ë…„ 1ì›” 21ì¼ ì˜¤í›„ 1:29

<aside>
ğŸ§© ê°œë°œ í™˜ê²½

- í”„ë ˆì„ì›Œí¬ : **NextJS 14.0.4, React v18**
- ì»¨ë²¤ì…˜ : **Prettier**, **TypeScript**
- ìŠ¤íƒ€ì¼ : **Tailwindcss** 3.3.0, **CSSModule**
</aside> 

![lightHouse ì¸¡ì • ê²°ê³¼](https://nnea5215.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fb67b8caf-0e30-4e9a-b6db-84175dd949a3%2F165f897c-416c-42e0-9b9b-bfc849edce25%2FUntitled.png?table=block&id=c0c7750d-9b60-4b1a-903e-b3ac7bfd186b&spaceId=b67b8caf-0e30-4e9a-b6db-84175dd949a3&userId=&cache=v2)

lightHouse ì¸¡ì • ê²°ê³¼

# ê¸°ëŠ¥ë³„ ì œì‘ ë¹„í™”.

## í˜ì´ì§€ ìŠ¬ë¼ì´ë“œ

ìŠ¬ë¼ì´ë“œ ê¸°ëŠ¥ì€ snap ì„ í™œìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

`components/index.tsx`

```jsx
import styles from "./Main.module.css";

const MainComponent = (): JSX.Element => {
  return (
    <div className={`${styles.slides}`}>
      <section className="snap-start" />
      <section className="snap-start" />
      <section className="snap-start" />
      <section className="snap-start" />
    </div>
  );
};
```

`components/Main.module.css`

```css
.slides {
  height: 100vh;  
  width: 100%;
  scroll-snap-type: y mandatory;
  scroll-behavior: smooth;
  overflow-y: scroll;
}
```

ê·¸ ê²°ê³¼ ìŠ¤í¬ë¡¤ì„ í–ˆì„ë•Œ `<section>` ì»´í¬ë„ŒíŠ¸ ìœ„ì¹˜ë¡œ ê°€ë„ë¡ ì ìš©ì€ ë˜ì—ˆìŠµë‹ˆë‹¤.

ë‹¤ë§Œ í•œ ê°€ì§€ ë¬¸ì œê°€ ìˆì—ˆëŠ”ë° PC ì—ì„œëŠ” ìŠ¤í¬ë¡¤ì„ ë©ˆì¶”ê³  ë‚˜ì„œì•¼, ë‹¤ìŒ ì„¹ì…˜ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤. ë§¤ìš° ë¶ˆí¸í•œë°, ìŠ¤í¬ë¡¤ì´ ì‹œì‘ëœ ì¦‰ì‹œ ì´ë™í•˜ê²Œ ìˆ˜ì •í•  í•„ìš”ê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë¯€ë¡œ í•´ë‹¹ `Section`ì—ì„œ wheel ì´ë²¤íŠ¸ì— ë‹¤ë¥¸ ë™ì‘ì„ í•˜ë„ë¡ ì´í•˜ì™€ ê°™ì´ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

```jsx
import styles from "./Main.module.css";
import { ScrollWheelAdjust } from "./adjustScroll";

const MainComponent = (): JSX.Element => {
	const divRefCallback = useCallback(ScrollWheelAdjust, []);

	return (
		<div className={`${styles.slides}`} ref={divRefCallback}>
			<section className="snap-start" />
			<section className="snap-start" />
			<section className="snap-start" />
			<section className="snap-start" />
		</div>
	)
}
```

`adjustScroll.ts`

```jsx
const onWheel = (node: HTMLDivElement) => (e: WheelEvent) => {
  e.preventDefault();
  if (e.deltaY > 0) {
    node.scrollTo(0, node.scrollTop + window.innerHeight);
  } else {
    node.scrollTo(0, node.scrollTop - window.innerHeight);
  }
};

export const ScrollWheelAdjust = (node: HTMLDivElement) => {
  if (node == null) {
    return;
  }
  node.addEventListener("wheel", onWheel(node), { passive: false });
};
```

**í•˜ì´ë“œë ˆì´ì…˜ì´ ì™„ë£Œëœ í›„ì˜ ì»´í¬ë„ŒíŠ¸ì— ëŒ€ì‘**í•´ì•„í•˜ë¯€ë¡œ, `useRef` ë¥¼ í†µí•´ ì´ë²¤íŠ¸ë¥¼ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

`wheel` ì˜ ì›ë˜ ê¸°ëŠ¥ì„ í•˜ì§€ ì•ŠëŠ” ëŒ€ì‹ , **í˜„ì¬ ìœ„ì¹˜ë¥¼ ë‹¤ìŒ / ì´ì „ í˜ì´ì§€ì˜ ìœ„ì¹˜ë¡œ** `scrollTo()` ë¡œ ì´ë²¤íŠ¸ë¥¼ ëŒ€ì‘í•˜ì—¬ ìŠ¤í¬ë¡¤ì´ ì‹œì‘ë˜ìë§ˆì ë§¤ë„ëŸ½ê²Œ ì´ë™í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ë ˆì´ì•„ì›ƒ ì• ë‹ˆë©”ì´ì…˜

ì‚¬ë°©ìœ¼ë¡œ í˜ì´ë“œì¸ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ì• ë‹ˆë©”ì´ì…˜ì€ ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ë™ì‘í•˜ë„ë¡ êµ¬í˜„ë˜ì–´ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ëª¨ë“  í˜ì´ì§€ê°€ ë™ì¼í•œ í˜•íƒœì˜ ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.

```jsx
export const SkillSection = (): JSX.Element => {
  const introduceRef = useCallback(fadeInOutApplier(390), []);
  return (
    <Section>
      <div ref={skillRef}>
        <div>
          <h1>MY SKILL CARDS</h1>
        </div>
        <SkillCards />
      </div>
    </Section>
  );
};
```

í™”ë©´ì— ë“¤ì–´ê°€ë©´ íŠ¸ë¦¬ê±°ê°€ ë°œë™í•˜ëŠ” `IntersectionObserber` ì˜ íƒ€ê²Ÿì€ **ìµœìƒìœ„ `div`** ë¡œ ì„¤ì •í•˜ê³  ê·¸ íƒ€ê²Ÿì˜ ì§ê³„ ìì†ì˜ ì»´í¬ë„ŒíŠ¸ë“¤ì´ ì• ë‹ˆë©”ì´ì…˜ì— ê±¸ë¦¬ë„ë¡ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

```jsx
export const fadeInOutApplier = (delay: number) => (node: HTMLDivElement) => {
  if (node == null) {
    return;
  }

  const observer = new IntersectionObserver(
    (entries: IntersectionObserverEntry[]) => {
      const sectionEl = entries[0];
      const childTarget: NodeListOf<HTMLDivElement> =
        sectionEl.target.querySelectorAll(":scope>div");
      if (sectionEl.isIntersecting) {
        childTarget.forEach((target: HTMLDivElement, index: number) => {
          setTimeout(() => {
            setHorizontalFadeInAnimation(target, index);
          }, 500 + delay * index);
        });
      } else {
        childTarget.forEach((target: HTMLDivElement) => {
          setFadeOut(target);
        });
      }
    },
    { threshold: 0.8 }
  );

  const childCollection: NodeListOf<HTMLDivElement> = node.querySelectorAll(":scope>div");
  childCollection.forEach((target: HTMLDivElement) => {
    setFadeOut(target);
  });

  observer.observe(node);
};
```

ì• ë‹ˆë©”ì´ì…˜ì˜ ì²˜ë¦¬ëŠ” ì²˜ìŒì—ëŠ” `opacity:0` ìœ¼ë¡œ ì£¼ì–´ íˆ¬ëª…í•˜ê²Œ ë§Œë“  ë‹¤ìŒ `fadeOut` `fadeIn` ê³¼ ê°™ì€ ì• ë‹ˆë©”ì´ì…˜ì´ ê±¸ë¦¬ëŠ” í´ë˜ìŠ¤ë¥¼ ì œì–´í•˜ëŠ” í•¨ìˆ˜ë“¤ë¡œ ëŒ€ì‘í•˜ì—¬ ì• ë‹ˆë©”ì´ì…˜ì„ ì£¼ì—ˆìŠµë‹ˆë‹¤.

`setTimeout` ìœ¼ë¡œ ë”œë ˆì´ë¥¼ ê±¸ì–´ì„œ ì›í•˜ëŠ” ì‹œê°„ì— ìˆœì°¨ì ìœ¼ë¡œ ì¶œë ¥ë˜ê²Œ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  í™”ë©´ì— ë³´ì´ì§€ ì•Šê²Œ ë˜ë©´ ë‹¤ì‹œ opacity:0 ìœ¼ë¡œ ë§Œë“œëŠ” í´ë˜ìŠ¤ë¥¼ ì ìš©í•˜ì—¬ ë‹¤ì‹œ ê°ì¶”ê²Œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

ì—¬ê¸°ê¹Œì§„ ê´œì°®ì€ë°? ë¬¸ì œê°€ í•˜ë‚˜ ìƒê²¼ìŠµë‹ˆë‹¤. ê·¸ê±´ ë°”ë¡œ ì¶œë ¥ì´ ë‹¤ ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ì´ë™í•´ë³´ë‹ˆ ì´ì „ì— ìˆë˜ ë‚´ìš©ë“¤ì´ ì‚¬ë¼ì§€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

ì›ì¸ì„ í™•ì¸í•´ë³´ë‹ˆ ì´ìœ ëŠ” ë‹¨ìˆœí–ˆìŠµë‹ˆë‹¤.

ì›ë˜ ì˜ë„ëŠ” â€¦

> `setHorizontalFadeInAnimation()` â†’ `setFadeOut()`

ë„ˆë¬´ ë¹ ë¥´ê²Œ ì´ë™í•˜ê²Œ ë˜ì–´ì„œ

> `setFadeOut()` â†’ `setHorizontalFadeInAnimation()`

ìˆœì„œë¡œ ë™ì‘í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ì´í•˜ì˜ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ì´ ë˜ì–´ì•¼í•©ë‹ˆë‹¤.

> `setHorizontalFadeInAnimation()` â†’ `await` â†’ `setFadeOut()`

**ìˆœì„œë¥¼ ë³´ì¥í•˜ë„ë¡ í•œë‹¤**ëŠ” í‚¤ì›Œë“œë¼ë©´ ë¨¼ì € ë– ì˜¤ë¥´ëŠ”ê²Œ `Promise` ì´ë¯€ë¡œ í•´ë‹¹ ë°©ì‹ìœ¼ë¡œ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.

```jsx
const createPromise = (target: HTMLDivElement, index: number): Promise<""> => {
    return new Promise((res) => {
      setTimeout(() => {
        setHorizontalFadeInAnimation(target, index);
        res("");
      }, 500 + delay * index);
    });
  };

  const observer = new IntersectionObserver(
    async (entries: IntersectionObserverEntry[]) => {
      const sectionEl = entries[0];
      const childTarget: NodeListOf<HTMLDivElement> =
        sectionEl.target.querySelectorAll(":scope>div");
      if (sectionEl.isIntersecting) {
        childTarget.forEach((target: HTMLDivElement, index: number) => {
          promises.push(createPromise(target, index));
        });
      } else {
        await Promise.all(promises);
        childTarget.forEach((target: HTMLDivElement) => {
          setFadeOut(target);
        });
      }
    },
    { threshold: 0.8 }
  );

	// ( ...í•˜ëµ )
}
```

ìœ„ ëŒ€ë¡œ í•˜ë©´, `setHorizontalFadeInAnimation()` ê°€ í”„ë¡œë¯¸ìŠ¤ì— ë“¤ì–´ê°€ê²Œ ë˜ê³ , ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ê²Œ ëœë‹¤ë©´, í”„ë¡œë¯¸ìŠ¤ì— ë“¤ì–´ê°„ ë©”ì†Œë“œë“¤ì´ ëª¨ë‘ ì™„ë£Œë˜ê¸°ê¹Œì§€ ê¸°ë‹¤ë¦° ë‹¤ìŒì— `setFadeOut()` ê°€ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.

## ìŠ¤í”Œë˜ì‹œ

ì§„ì…ì‹œ ì²˜ìŒ ë³´ì´ëŠ” í™”ë©´ì€ ë¦¬ì•¡íŠ¸ì˜ `Suspense` ë¥¼ í™œìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ì²˜ìŒì— ë³´ì´ëŠ” í™”ë©´ì€ ë¡œë”© í™”ë©´ìœ¼ë¡œ í™œìš©í•  ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ `page.tsx` ì™€ ë™ì¼í•œ ê³³ì— `loading.tsx` ë¥¼ ë„£ì–´ì„œ í•´ê²°í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

`app/page.tsx`

```jsx
export default async function Home() {
  const promise = new Promise((res) => {
    setTimeout(() => {
      res(true);
    }, splashTime);
  });

  const data = await promise.then();

  return data && <MainComponent />;
}
```

ê·¸ëŸ°ë°?? í…ŒìŠ¤íŠ¸ í•´ë³´ì•˜ì„ ë• ë¬¸ì œ ì—†ì—ˆì§€ë§Œ **amplify ì— ë°°í¬í•œ í›„ì— ìŠ¤í”Œë˜ì‹œê°€ ì•ˆë³´ì´ëŠ” ë¬¸ì œ**ê°€ ì¼ì–´ë‚¬ìŠµë‹ˆë‹¤.

ì›ì¸ì€ ì¡°ê¸ˆë§Œ ìƒê°í•´ë³´ë©´ ì•Œ ìˆ˜ ìˆë‹¤. `page.tsx` ëŠ” ì„œë²„ ì»´í¬ë„ŒíŠ¸ì¸ë° [NextJS ê³µì‹ë¬¸ì„œ](https://nextjs.org/docs/app/building-your-application/caching#request-memoization)ë¥¼ ë³´ë©´, ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìš”ì²­í•œ ë©”ì†Œë“œ ì‘ë‹µì€ ë¹Œë“œì‹œ ë§Œì•½ **ë³€ë™ì´ ì—†ë‹¤ê³  ì¸ì§€**í•˜ë©´ ì‘ë‹µì€ ìºì‹±ëœë‹¤ê³  í•œë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ìš”ì²­ ì‘ë‹µì´ ì™„ë£Œê¹Œì§€ ê¸°ë‹¤ë¦´ í•„ìš”ê°€ ì—†ì–´ì¡Œìœ¼ë¯€ë¡œ ë¡œë”©í™”ë©´ì„ ë³´ì—¬ì£¼ì§€ ì•Šê³  ìˆì—ˆë‹¤.

ë„ˆë¬´ ë¹ ë¥´ê²Œ ë§Œë“¤ì–´ì•¼ í•˜ëŠ” nextJS ì˜ ì§€í–¥ì ì´ ì˜¤íˆë ¤ ë°œëª©ì„ ì¡ì€ ì…ˆì´ë‹¤. ê°œë°œí™˜ê²½ì—ì„  strict ëª¨ë“œë¥¼ ì‚¬ìš©ì¤‘ì´ë¯€ë¡œ ìºì‹±ì´ ì¼ì–´ë‚˜ì§€ ì•Šì•„ì„œ ì¸ì§€í•˜ê¸°ê°€ ì–´ë ¤ìš´ ë¬¸ì œë‹¤.

ê·¸ëŸ¬ë¯€ë¡œ **`page.tsx`ë¥¼ ì„œë²„ì‚¬ì´ë“œ ì»´í¬ë„ŒíŠ¸ë¡œ ë³€ê²½**í•˜ê³  í˜¸ì¶œì„ í•˜ëŠ” ë™ì•ˆ ë¡œë”©í™”ë©´ì´ ë‚˜ì˜¤ë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.

`app/page.tsx`

```tsx
"use client";
import MainComponent from "@/components";
import { splashTime } from "./loadingControlOption";

let promise: Promise<any> | undefined;
let promiseStatus: "fulfilled" | "rejected" | "pending" = "pending";
let promiseValue: any;

export default function Home() {
  wrapPromise();
  return promiseValue && <MainComponent />;
}

function wrapPromise() {
  if (!promise) {
    promise = new Promise((res) => {
      setTimeout(() => {
        res("TRUE");
      }, splashTime);
    });
  }

  if (promiseStatus === "fulfilled") {
    return promiseValue;
  } else {
    promiseStatus = "pending";
    promise.then((result) => {
      promiseStatus = "fulfilled";
      promiseValue = result;
    });
  }
  throw promise;
}
```

êµ¬ì¡°ê°€ ë‹¤ì†Œ ë³µì¡í•´ ë³´ì´ì§€ë§Œ ìˆœì„œëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

1. `wrapPromise` ê°€ ì‹¤í–‰ë˜ì–´ íŠ¹ì • ì‹œê°„ë™ì•ˆ pending ì´ ë˜ë„ë¡ setTimeout ì´ ê±¸ë¦° í”„ë¡œë¯¸ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ì „ì—­ ë³€ìˆ˜ `promise` ì— í• ë‹¹.

   ì „ì—­ë³€ìˆ˜ë¡œ í•˜ëŠ” ì´ìœ ëŠ” `throw promise` ê°€ ì‹¤í–‰ë˜ë©´ì„œ `wrapPromise` ê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ëŠ”ë° ì „ì—­ìœ¼ë¡œ ë‘ì§€ ì•Šìœ¼ë©´ ì°¸ì¡°í•  ê³³ì´ ì—†ì–´ì„œ ëì—†ì´ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

2. ì²˜ìŒì—ëŠ” `fulfilled` ê°€ ì•„ë‹ˆë¯€ë¡œ `promise`ì˜ ì½œë°± í•¨ìˆ˜ ì„¤ì •.
3. `throw promise`ê°€ `splashTime` ë§Œí¼ íƒ€ì´ë¨¸ê°€ ì§€ë‚˜ê³  ì‹¤í–‰ë˜ì–´ `wrapPromise` ì¬ì‹¤í–‰.
4. `promiseStatus = "fulfilled"` ì´ë¯€ë¡œ í•´ë‹¹ ê°’ì´ ë¦¬í„´ë˜ë©° ì‹¤í–‰ì´ ì¢…ë£Œ.
5. Home ì˜ promiseValue ê°€ ì´ì œ í”„ë¡œë¯¸ìŠ¤ê°€ ì™„ë£Œëœ ê°’ì´ ë˜ì—ˆìœ¼ë¯€ë¡œ ì„œìŠ¤íŒ¬ìŠ¤ê°€ ëë‚˜ê³ `<MainComponent />` ê°€ ì¶œë ¥.

ì´ì œ ìˆ˜ì •ëœ ë‚´ìš©ì„ ì‹¤ì œ í™˜ê²½ì— ë°°í¬í•˜ë‹ˆ ì˜ë„ëŒ€ë¡œ ì‹¤í–‰ë˜ê³  ìˆë‹¤.

---

# TODOS

## ë””ìì¸ì´ ë³„ë¡œë‹¤!! ğŸ«£

- ì• ë‹ˆë©”ì´ì…˜ì„ ì¶”ê°€í• ê¹Œ?
- ë ˆì´ì•„ì›ƒì„ ë°”ê¿”ë³¼ê¹Œ?

## êµ¬ì²´ì ì¸ ë‚´ìš©ë“¤

- ì‹œë©˜í‹± íƒœê·¸ë¥¼ ìµœëŒ€í•œ ë„£ì–´ë³´ê¸°.
- í˜„ì¬ ìœ„ì¹˜ê°€ ì–´ë”˜ì§€ í‘œì‹œí•˜ëŠ” ë„¤ë¹„ê²Œì´ì…˜ ê¸°ëŠ¥.
- ì–´ë“œë¯¼ ê¸°ëŠ¥ìœ¼ë¡œ ë°°í¬ ì—†ì´ ë‚´ìš©ì„ ìˆ˜ì •í•  ìˆ˜ ìˆì„ê¹Œ?
- ì¹´ë“œì— ë°˜ì§ì´ëŠ” íš¨ê³¼ ë„£ì–´ë³´ê¸°.

ë°˜ì‘í˜• ìˆ˜ì •ì€ ë” ë‚˜ì¤‘ì— ìƒê°í•´ë³´ëŠ”ë°, ìŠ¬ë¼ì´ë“œ í˜•ì‹ì´ë¯€ë¡œ ë ˆì´ì•„ì›ƒë¶€í„° ë¦¬ë‰´ì–¼ì„ í•´ì•¼ í•  ê²ƒ ê°™ë‹¤.
